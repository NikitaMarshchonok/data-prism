<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–û—Ç—á–µ—Ç Data Prism</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 40px;
            background-color: #f9f9f9;
            color: #333;
        }
        h1 { font-size: 32px; margin-bottom: 10px; }
        h2 {
            margin-top: 40px;
            font-size: 24px;
            border-bottom: 2px solid #ccc;
            padding-bottom: 6px;
        }
        h3 { font-size: 20px; margin-bottom: 10px; }
        .section { margin-bottom: 50px; }
        .chart { margin: 30px 0; padding-bottom: 10px; border-bottom: 1px solid #ddd; }
        .chart p {
            margin-top: 10px;
            font-size: 15px;
            color: #444;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th {
            background-color: #0066cc;
            color: white;
            padding: 10px;
            text-align: left;
        }
        td {
            background-color: #fff;
            padding: 10px;
            border-bottom: 1px solid #ccc;
        }
        .download-button {
            display: inline-block;
            background-color: #0066cc;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <h1>–û—Ç—á–µ—Ç Data Prism</h1>

    <!-- üîΩ –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è PDF -->
    <div>
        <a href="/download-pdf" class="download-button">üìÑ –°–∫–∞—á–∞—Ç—å –æ—Ç—á–µ—Ç –≤ PDF</a>
    </div>

    {% if column_overview %}
    <div class="section">
        <h2>üìã –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</h2>
        <table>
            <tr>
                <th>–°—Ç–æ–ª–±–µ—Ü</th>
                <th>–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö</th>
                <th>–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</th>
            </tr>
            {% for col, info in column_overview.items() %}
            <tr>
                <td>{{ col }}</td>
                <td>{{ info.dtype }}</td>
                <td>{{ info.unique }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}

    <div class="section">
        <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
        <table>
            <tr>
                <th>–°—Ç–æ–ª–±–µ—Ü</th>
                <th>–°—Ä–µ–¥–Ω–µ–µ</th>
                <th>–ú–µ–¥–∏–∞–Ω–∞</th>
                <th>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</th>
                <th>–ú–∏–Ω</th>
                <th>–ú–∞–∫—Å</th>
            </tr>
            {% for col, metrics in stats.items() %}
            <tr>
                <td><b>{{ col }}</b></td>
                <td>{{ metrics.mean | round(2) }}</td>
                <td>{{ metrics.median | round(2) }}</td>
                <td>{{ metrics.std | round(2) }}</td>
                <td>{{ metrics.min | round(2) }}</td>
                <td>{{ metrics.max | round(2) }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>

    {% if missing_data %}
    <div class="section">
        <h2>üìâ –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</h2>
        <table>
            <tr>
                <th>–°—Ç–æ–ª–±–µ—Ü</th>
                <th>–ö–æ–ª-–≤–æ</th>
                <th>%</th>
            </tr>
            {% for col, info in missing_data.items() %}
            <tr>
                <td>{{ col }}</td>
                <td>{{ info.count }}</td>
                <td>{{ info.percent }}%</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}

    {% if corr_chart %}
    <div class="section">
        <h2>üß† –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞</h2>
        {{ corr_chart | safe }}
        <p style="font-size: 15px; color: #444;">–ü–æ–∫–∞–∑–∞–Ω—ã –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –º–µ–∂–¥—É —á–∏—Å–ª–æ–≤—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏. –ß–µ–º –±–ª–∏–∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫ 1 –∏–ª–∏ -1 ‚Äî —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —Å–≤—è–∑—å –º–µ–∂–¥—É —Å—Ç–æ–ª–±—Ü–∞–º–∏.</p>
    </div>
    {% endif %}

    {% if categorical_data %}
    <div class="section">
        <h2>üî† –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</h2>
        {% for col, info in categorical_data.items() %}
            <h3>{{ col }}</h3>
            <table>
                <tr><th>–ó–Ω–∞—á–µ–Ω–∏–µ</th><th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th></tr>
                {% for val, count in info.table.items() %}
                <tr>
                    <td>{{ val }}</td>
                    <td>{{ count }}</td>
                </tr>
                {% endfor %}
            </table>
            <div class="chart">
                {{ info.chart | safe }}
                <p>–≠—Ç–∞ –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–µ <b>{{ col }}</b>. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –¥–∞–Ω–Ω—ã—Ö.</p>
            </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if time_trends %}
    <div class="section">
        <h2>üïí –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã</h2>
        {% for col, chart_html in time_trends.items() %}
        <div class="chart">
            <h3>{{ col }}</h3>
            {{ chart_html | safe }}
            <p>
                –≠—Ç–æ—Ç –≥—Ä–∞—Ñ–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç <strong>–¥–∏–Ω–∞–º–∏–∫—É</strong> –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π <strong>{{ col }}</strong> —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º.
                –û–Ω –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å —Ç—Ä–µ–Ω–¥—ã, –ø–∏–∫–∏ –∏ –ø—Ä–æ–≤–∞–ª—ã –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö.
            </p>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="section">
        <h2>üìà –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏</h2>
        {% for col, chart_html in interactive_charts.items() %}
        <div class="chart">
            {{ chart_html | safe }}
            <p>{{ column_descriptions[col] | safe }}</p>
        </div>
        {% endfor %}
    </div>
</body>
</html>
